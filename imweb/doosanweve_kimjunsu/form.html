<!--
  ================================================
  100zoad ì…ë ¥í¼ ì»´í¬ë„ŒíŠ¸ - Cloudflare Pages ë²„ì „
  ================================================

  ë°°í¬: https://100zoad-components.pages.dev
  ê³ ê°ì‚¬: ë‘ì‚°ìœ„ë¸Œë”ì œë‹ˆìŠ¤ ì„¼íŠ¸ëŸ´ì²œì•ˆ (ê¹€ì¤€ìˆ˜)
  ë²„ì „: 2.1.0 (ë¡œë”© ìˆœì„œ ì œì–´ ì¶”ê°€)

  í¬í•¨ ì»´í¬ë„ŒíŠ¸:
  - âœ… ì…ë ¥í¼ (ê´€ì‹¬ê³ ê° ë“±ë¡)

  ì‚¬ìš©ë²•:
  1. ì•„ì„ì›¹ í˜ì´ì§€ ì›í•˜ëŠ” ìœ„ì¹˜ì— HTML ìœ„ì ¯ ì¶”ê°€
  2. ì´ íŒŒì¼ ì „ì²´ë¥¼ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°
  3. ì €ì¥

  ì£¼ì˜: main.htmlì´ ë¨¼ì € ë¡œë“œë˜ì–´ì•¼ í•©ë‹ˆë‹¤!

  ================================================
-->

<!-- Pretendard í°íŠ¸ (ì´ë¯¸ main.htmlì—ì„œ ë¡œë“œë¨, ì¤‘ë³µ ë°©ì§€ìš©) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">

<!-- ì…ë ¥í¼ ì„¹ì…˜ (ì»¨í…Œì´ë„ˆ) -->
<div id="form-section">
  <!-- ì»´í¬ë„ŒíŠ¸ê°€ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
</div>

<!-- CONFIG ì„¤ì • ë° ì»´í¬ë„ŒíŠ¸ ìƒì„± -->
<script>
(function() {
  // CONFIG ë³‘í•© í•¨ìˆ˜
  function mergeFormConfig() {
    // ZOAD_CONFIGê°€ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
    if (!window.ZOAD_CONFIG) {
      window.ZOAD_CONFIG = {
        meta: {
          siteName: 'ë‘ì‚°ìœ„ë¸Œë”ì œë‹ˆìŠ¤ ì„¼íŠ¸ëŸ´ì²œì•ˆ'
        }
      };
    }

    // ì…ë ¥í¼ ì„¤ì • ì¶”ê°€/ë³‘í•©
    window.ZOAD_CONFIG.form = {
      enabled: true,
      title: 'ê´€ì‹¬ê³ ê° ë“±ë¡',
      description: 'ê°„ë‹¨í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì‹œë©´ ìƒë‹´ ì „í™”ë¥¼ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.',
      displayMode: 'section', // 'popup', 'section', 'both'
      fields: {
        name: {
          label: 'ì´ë¦„',
          placeholder: 'í™ê¸¸ë™',
          required: true
        },
        phone: {
          label: 'ì „í™”ë²ˆí˜¸',
          placeholder: '010-1234-5678',
          required: true
        }
      },
      airtable: {
        workerUrl: 'https://100zoad-airtable-proxy.choiwseok.workers.dev/submit'
      },
      messages: {
        success: 'âœ“ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!',
        error: 'ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'
      },
      styles: {
        primaryColor: '#003DA5',
        bgColor: '#ffffff',
        textColor: '#333333'
      }
    };

    console.log('âœ… [form.html] CONFIG ì„¤ì • ì™„ë£Œ');
  }

  // ì»´í¬ë„ŒíŠ¸ ìƒì„± í•¨ìˆ˜
  function createFormComponent() {
    const container = document.getElementById('form-section');
    if (!container) {
      console.error('âŒ [form.html] form-section ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
      return;
    }

    // ì´ë¯¸ ìƒì„±ëœ ê²½ìš° ìŠ¤í‚µ
    if (container.querySelector('zoad-form')) {
      console.log('â­ï¸ [form.html] zoad-formì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤');
      return;
    }

    // ì»´í¬ë„ŒíŠ¸ ìƒì„±
    const formElement = document.createElement('zoad-form');
    container.appendChild(formElement);
    console.log('âœ… [form.html] zoad-form ì»´í¬ë„ŒíŠ¸ ìƒì„±');

    // ë Œë”ë§ í™•ì¸
    setTimeout(function() {
      if (formElement.shadowRoot) {
        console.log('âœ… [form.html] ì…ë ¥í¼ ë Œë”ë§ ì™„ë£Œ');
      } else {
        console.warn('âš ï¸ [form.html] ì…ë ¥í¼ ë Œë”ë§ ì‹¤íŒ¨ - shadowRoot ì—†ìŒ');
      }
    }, 500);
  }

  // main.htmlì˜ ZOADê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ëŒ€ê¸°
  function waitForZoadReady(callback) {
    // ì´ë¯¸ ì¤€ë¹„ëœ ê²½ìš°
    if (window.__ZOAD_READY__) {
      console.log('âœ… [form.html] ZOAD ì´ë¯¸ ì¤€ë¹„ë¨');
      callback();
      return;
    }

    // zoad-formì´ ë“±ë¡ë  ë•Œê¹Œì§€ ëŒ€ê¸°
    if (customElements.get('zoad-form')) {
      console.log('âœ… [form.html] zoad-form ì´ë¯¸ ë“±ë¡ë¨');
      callback();
      return;
    }

    console.log('â³ [form.html] ZOAD ì¤€ë¹„ ëŒ€ê¸° ì¤‘...');

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¡œ ëŒ€ê¸°
    window.addEventListener('zoad-ready', function() {
      console.log('âœ… [form.html] zoad-ready ì´ë²¤íŠ¸ ìˆ˜ì‹ ');
      callback();
    }, { once: true });

    // í´ë§ìœ¼ë¡œë„ ëŒ€ê¸° (ì´ë²¤íŠ¸ê°€ ì´ë¯¸ ë°œìƒí•œ ê²½ìš° ëŒ€ë¹„)
    let attempts = 0;
    const maxAttempts = 100; // 10ì´ˆ

    const checkInterval = setInterval(function() {
      attempts++;

      if (window.__ZOAD_READY__ || customElements.get('zoad-form')) {
        clearInterval(checkInterval);
        callback();
      } else if (attempts >= maxAttempts) {
        clearInterval(checkInterval);
        console.error('âŒ [form.html] ZOAD ì¤€ë¹„ íƒ€ì„ì•„ì›ƒ');
        // ê·¸ë˜ë„ ì‹œë„í•´ë´„
        callback();
      }
    }, 100);
  }

  // ì‹¤í–‰
  mergeFormConfig();

  waitForZoadReady(function() {
    // zoad-formì´ ì •ì˜ë  ë•Œê¹Œì§€ ì¶”ê°€ ëŒ€ê¸°
    customElements.whenDefined('zoad-form').then(function() {
      console.log('âœ… [form.html] zoad-form ì •ì˜ ì™„ë£Œ');
      createFormComponent();
    }).catch(function(err) {
      console.error('âŒ [form.html] zoad-form ì •ì˜ ì‹¤íŒ¨:', err);
    });
  });
})();
</script>

<!--
  ================================================
  ğŸ“ ì¶”ê°€ í•„ë“œ ì„¤ì • ì˜ˆì‹œ
  ================================================

  ì•„ë˜ ì£¼ì„ì„ í•´ì œí•˜ì—¬ ì¶”ê°€ í•„ë“œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

  <script>
  // ì´ë©”ì¼ í•„ë“œ ì¶”ê°€
  window.ZOAD_CONFIG.form.fields.email = {
    type: 'text',
    label: 'ì´ë©”ì¼',
    placeholder: 'example@email.com',
    required: false
  };

  // ê´€ì‹¬í‰í˜• ì„ íƒ ì¶”ê°€
  window.ZOAD_CONFIG.form.fields.interest = {
    type: 'select',
    label: 'ê´€ì‹¬í‰í˜•',
    options: ['84ã¡', '99ã¡', '110ã¡', 'ê¸°íƒ€'],
    required: false
  };

  // ë¬¸ì˜ì‚¬í•­ ì¶”ê°€
  window.ZOAD_CONFIG.form.fields.message = {
    type: 'textarea',
    label: 'ë¬¸ì˜ì‚¬í•­',
    placeholder: 'ê¶ê¸ˆí•œ ì ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”',
    required: false
  };
  </script>

  ================================================
-->
